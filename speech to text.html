<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Speech to Text | LollyPoPdf</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><style>:root{--primary:#9370db;--primary-dark:#8a2be2;--secondary:#f0ebff;--text:#333;--text-light:#6b7280;--bg:#fff;--bg-sec:#f9f9f9;--radius:12px;--trans:all .3s ease;--shadow:0 4px 6px #0000001a;--header-h:80px;--white:#fff;--header-text:#6b7280;--accent:#9370db;--success:#10b981;--warning:#f59e0b;--error:#ef4444}.dark-mode{--primary:#a391f2;--primary-dark:#8a2be2;--secondary:#2d2d2d;--text:#f0f0f0;--text-light:#a0a0a0;--bg:#1a1a1a;--bg-sec:#2d2d2d;--shadow:0 4px 6px #0000004d;--white:#1a1a1a;--header-text:#a0a0a0}*{margin:0;padding:0;box-sizing:border-box;transition:var(--trans);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}input,textarea,.language-select,.transcription-output{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}body{font-family:'Segoe UI',sans-serif;background:var(--bg);color:var(--text);line-height:1.6}a{text-decoration:none;color:inherit}ul{list-style:none}.container{width:100%;max-width:1200px;margin:0 auto;padding:0 20px}header{background:var(--white);color:var(--header-text);box-shadow:0 2px 10px #0000001a;position:sticky;top:0;z-index:1e3}.header-container{display:flex;justify-content:space-between;align-items:center;padding:15px 0}.logo{display:flex;align-items:center;gap:10px}.logo-icon{position:relative;width:40px;height:40px}.logo-circle{width:40px;height:40px;border-radius:40%;background:linear-gradient(135deg,#9370db,#8a2be2);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:14px}.logo-stem{position:absolute;bottom:-17px;left:50%;transform:translateX(-50%);width:6px;height:17px;background:#8a2be2;border-radius:0 0 3px 3px}.logo-text{font-size:24px;font-weight:700;color:#9370db}nav ul{display:flex;gap:30px}nav a{font-weight:500;position:relative;color:var(--header-text);padding:8px 0}.nav-link::after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:2px;background:var(--accent);transition:width .3s}.nav-link:hover::after{width:100%}.header-right{display:flex;align-items:center;gap:20px}.email{font-size:14px}.theme-toggle{background:0 0;border:none;cursor:pointer;font-size:20px;color:var(--header-text);padding:8px;border-radius:50%}.theme-toggle:hover{background:#f0ebff;color:var(--accent)}.dark-mode .theme-toggle:hover{background:#2d3748;color:var(--accent)}.mobile-menu-btn{display:none;background:0 0;border:none;font-size:24px;cursor:pointer;color:var(--header-text)}.mobile-menu{display:none;position:absolute;top:100%;left:0;width:100%;background:var(--white);box-shadow:var(--shadow);z-index:999}.mobile-menu.active{display:block}.mobile-menu ul{padding:20px;display:flex;flex-direction:column;gap:15px}.mobile-menu a{display:block;padding:10px 0;border-bottom:1px solid rgba(0,0,0,.1);color:var(--header-text)}.dark-mode .mobile-menu a{border-bottom:1px solid rgba(255,255,255,.1)}.hero{background:var(--secondary);padding:60px 0;text-align:center}.dark-mode .hero{background:linear-gradient(135deg,#2a1a4a,#3d2a6d)}.hero h1{font-size:2.5rem;margin-bottom:15px;color:#000}.dark-mode .hero h1{color:var(--text)}.hero p{font-size:1.2rem;color:var(--text);max-width:700px;margin:0 auto 30px}.how-to-section{padding:80px 0;background:var(--bg)}.dark-mode .how-to-section{background:var(--bg-sec)}.section-title{font-size:2rem;text-align:center;margin-bottom:40px;color:#000}.dark-mode .section-title{color:var(--text)}.steps-container{display:grid;grid-template-columns:repeat(2,1fr);gap:40px}.step-box{background:var(--bg-sec);border-radius:var(--radius);box-shadow:var(--shadow);padding:30px;min-height:200px}.step-number{width:40px;height:40px;background:var(--primary);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;margin-bottom:15px}.step-title{font-size:18px;color:#000;margin-bottom:10px}.dark-mode .step-title{color:var(--text)}.step-description{font-size:14px;color:var(--text);line-height:1.6}.tool-section{padding:80px 0;background:var(--secondary)}.dark-mode .tool-section{background:linear-gradient(135deg,#2a1a4a,#3d2a6d)}.tool-title{font-size:2.5rem;text-align:center;margin-bottom:40px;color:#a391f2}.tool-container{max-width:1000px;margin:0 auto;background:var(--bg);border-radius:var(--radius);box-shadow:var(--shadow);padding:40px}.recording-container{background:var(--bg-sec);border-radius:var(--radius);padding:30px;margin-bottom:30px;text-align:center}.recording-title{font-size:18px;margin-bottom:20px;color:var(--primary)}.recording-controls{display:flex;justify-content:center;gap:15px;margin-bottom:20px}.recording-btn{padding:12px 25px;border:none;border-radius:30px;cursor:pointer;font-weight:700;transition:var(--trans);display:flex;align-items:center;gap:8px}.record-btn{background:var(--primary);color:#fff}.stop-btn{background:var(--error);color:#fff;display:none}.recording-indicator{display:none;align-items:center;justify-content:center;gap:10px;margin-top:15px}.recording-dot{width:10px;height:10px;background:var(--error);border-radius:50%;animation:pulse 1.5s infinite}@keyframes pulse{0%{opacity:1}50%{opacity:.5}100%{opacity:1}}.recording-timer{font-size:16px;font-weight:700;color:var(--error)}.language-container{background:var(--bg-sec);border-radius:var(--radius);padding:20px;margin-bottom:30px}.language-title{font-size:18px;margin-bottom:15px;color:var(--primary)}.language-select{width:100%;padding:12px;border-radius:var(--radius);border:1px solid var(--primary);background:var(--bg);color:var(--text);font-size:16px}.transcription-container{background:var(--bg-sec);border-radius:var(--radius);padding:30px;margin-bottom:30px}.transcription-title{font-size:18px;margin-bottom:15px;color:var(--primary)}.transcription-output{min-height:200px;max-height:400px;overflow-y:auto;padding:15px;background:var(--bg);border-radius:var(--radius);border:1px solid var(--primary);margin-bottom:15px;font-size:16px;line-height:1.6;white-space:pre-wrap}.transcription-actions{display:flex;gap:15px;justify-content:flex-end;flex-wrap:wrap}.copy-btn,.clear-btn,.email-btn{padding:8px 15px;border:none;border-radius:var(--radius);cursor:pointer;transition:var(--trans);display:flex;align-items:center;gap:5px}.copy-btn{background:var(--primary);color:#fff}.clear-btn{background:#fff;color:var(--primary);border:2px solid var(--primary)}.email-btn{background:var(--primary);color:#fff;display:none}.stats-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;margin-bottom:30px}.stat-box{background:var(--bg-sec);border-radius:var(--radius);padding:20px;text-align:center;box-shadow:var(--shadow)}.stat-value{font-size:2rem;font-weight:700;color:var(--primary);margin-bottom:5px}.stat-label{font-size:14px;color:var(--text-light)}.loading-indicator{display:none;margin:10px 0;padding:10px;background:var(--primary);color:#fff;border-radius:var(--radius);text-align:center}footer{background:#000;color:#fff;padding:60px 0 80px;position:relative}.footer-container{display:grid;grid-template-columns:1fr 1fr 1fr;gap:60px}.footer-logo{display:flex;align-items:center;gap:10px;margin-bottom:20px}.footer-logo .logo-text{color:#9370db;font-size:24px;font-weight:700}.footer-section h3{color:#fff;font-weight:600;font-size:20px;margin-bottom:20px}.footer-section h4{color:#9370db;font-size:18px;margin-bottom:15px}.footer-links li{margin-bottom:10px}.footer-links a{color:#fff;font-size:14px}.footer-links a:hover{color:#9370db}.social-icons{display:flex;gap:15px;margin-top:20px}.social-icon{width:40px;height:40px;background:#9370db;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:var(--trans)}.social-icon:hover{background:#8a2be2;transform:translateY(-3px)}.copyright{position:absolute;bottom:10px;left:10px;color:#f9f7ff;font-size:12px}.footer-line{position:absolute;bottom:50px;left:0;width:100%;height:1px;background:rgba(255,255,255,.2)}.language-switcher{position:fixed;bottom:10px;right:10px;z-index:1e3}.language-btn{background:#9370db;color:#fff;border:none;border-radius:30px;padding:5px 10px;cursor:pointer;display:flex;align-items:center;gap:4px;box-shadow:0 4px 10px #0003}.language-dropdown{position:absolute;bottom:100%;right:0;width:300px;background:#fff;border-radius:var(--radius);box-shadow:0 5px 15px rgba(0,0,0,.1);padding:20px;display:none;grid-template-columns:repeat(3,1fr);gap:10px;max-height:300px;overflow-y:auto}.dark-mode .language-dropdown{background:var(--bg-sec)}.language-switcher:hover .language-dropdown{display:grid}.language-option{padding:8px;border-radius:6px;cursor:pointer;text-align:center;font-size:14px;transition:var(--trans)}.language-option:hover{background:#9370db;color:#fff}.dark-mode .language-option:hover{background:#9370db;color:#fff}@media (max-width:992px){.steps-container{grid-template-columns:1fr}.footer-container{grid-template-columns:1fr 1fr}}@media (max-width:768px){nav ul,.email{display:none}.mobile-menu-btn{display:block}.hero h1,.tool-title{font-size:2rem}.hero p{font-size:1rem}.language-dropdown{width:250px;grid-template-columns:repeat(2,1fr)}.footer-container{grid-template-columns:1fr}.stats-container{grid-template-columns:1fr 1fr}.recording-controls{flex-direction:column;align-items:center}.transcription-actions{flex-direction:column}}@media (max-width:576px){.tool-container{padding:20px}.stats-container{grid-template-columns:1fr}}</style></head><body><header><div class="container header-container"><a href="https://lollypopdf.com" class="logo"><div class="logo-icon"><div class="logo-circle">LPdf</div><div class="logo-stem"></div></div><span class="logo-text">LollyPoPdf</span></a><nav><ul><li><a href="https://lollypopdf.com#home" class="nav-link" data-i18n="nav.home">Home</a></li><li><a href="https://lollypopdf.com#about" class="nav-link" data-i18n="nav.about">About Us</a></li><li><a href="https://lollypopdf.com#tools" class="nav-link" data-i18n="nav.tools">Tools</a></li><li><a href="https://lollypopdf.com#contact.html" class="nav-link" data-i18n="nav.contact">Contact</a></li></ul></nav><div class="header-right"><span class="email">contact@lollypopdf.com</span><button class="theme-toggle" id="themeToggle"><i class="fas fa-moon"></i></button><button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button></div></div><div class="mobile-menu" id="mobileMenu"><ul><li><a href="https://lollypopdf.com#home" data-i18n="nav.home">Home</a></li><li><a href="https://lollypopdf.com#about" data-i18n="nav.about">About Us</a></li><li><a href="https://lollypopdf.com#tools" data-i18n="nav.tools">Tools</a></li><li><a href="https://lollypopdf.com#contact.html" data-i18n="nav.contact">Contact</a></li></ul></div></header><section class="hero"><div class="container"><h1 data-i18n="hero.title">Speech to Text Tool</h1><p data-i18n="hero.description">Convert speech to text with high accuracy - record audio and get instant transcription with automatic punctuation. All processing happens locally with complete privacy.</p></div></section><section class="how-to-section"><div class="container"><h2 class="section-title" data-i18n="howto.title">How to Use the Speech to Text Tool</h2><div class="steps-container"><div class="step-box"><div class="step-number">1</div><h3 class="step-title" data-i18n="howto.step1.title">Select Language</h3><p class="step-description" data-i18n="howto.step1.description">Choose your preferred language from the dropdown menu. The tool supports multiple languages for accurate transcription with local punctuation.</p></div><div class="step-box"><div class="step-number">2</div><h3 class="step-title" data-i18n="howto.step2.title">Start Recording</h3><p class="step-description" data-i18n="howto.step2.description">Click the 'Start Recording' button to begin live transcription. The tool will automatically transcribe your speech with punctuation.</p></div><div class="step-box"><div class="step-number">3</div><h3 class="step-title" data-i18n="howto.step3.title">Transcribe & Preview</h3><p class="step-description" data-i18n="howto.step3.description">Watch your speech being transcribed in real-time. The text will appear with proper punctuation and formatting.</p></div><div class="step-box"><div class="step-number">4</div><h3 class="step-title" data-i18n="howto.step4.title">Copy or Email</h3><p class="step-description" data-i18n="howto.step4.description">Copy the transcribed text to clipboard or send it directly to your email application with one click.</p></div></div></div></section><section class="tool-section"><div class="container"><h2 class="tool-title" data-i18n="tool.title">Speech to Text</h2><div class="tool-container"><div class="recording-container"><h3 class="recording-title" data-i18n="tool.recording.title">Record Audio</h3><div class="recording-controls"><button class="recording-btn record-btn" id="recordBtn"><i class="fas fa-microphone"></i> <span data-i18n="tool.recording.start">Start Recording</span></button><button class="recording-btn stop-btn" id="stopBtn"><i class="fas fa-stop"></i> <span data-i18n="tool.recording.stop">Stop Recording</span></button></div><div class="recording-indicator" id="recordingIndicator"><div class="recording-dot"></div><div class="recording-timer" id="recordingTimer">00:00</div></div></div><div class="language-container"><h3 class="language-title" data-i18n="tool.language.title">Language Selection</h3><select id="languageSelect" class="language-select"></select></div><div class="transcription-container"><h3 class="transcription-title" data-i18n="tool.transcription.title">Transcription</h3><div class="transcription-output" id="transcriptionOutput" data-i18n="tool.transcription.placeholder">Your transcribed text will appear here...</div><div class="transcription-actions"><button class="copy-btn" id="copyBtn"><i class="fas fa-copy"></i> <span data-i18n="tool.transcription.copy">Copy Text</span></button><button class="email-btn" id="emailBtn"><i class="fas fa-envelope"></i> <span data-i18n="tool.transcription.email">Create Email</span></button><button class="clear-btn" id="clearBtn"><i class="fas fa-trash"></i> <span data-i18n="tool.transcription.clear">Clear</span></button></div></div><div class="loading-indicator" id="loadingIndicator"><i class="fas fa-spinner fa-spin"></i> <span data-i18n="tool.loading">Processing Audio...</span></div><div class="stats-container"><div class="stat-box"><div class="stat-value" id="recordingTime">0:00</div><div class="stat-label" data-i18n="tool.stats.duration">Recording Time</div></div><div class="stat-box"><div class="stat-value" id="wordCount">0</div><div class="stat-label" data-i18n="tool.stats.words">Words</div></div><div class="stat-box"><div class="stat-value" id="characterCount">0</div><div class="stat-label" data-i18n="tool.stats.characters">Characters</div></div><div class="stat-box"><div class="stat-value" id="accuracy">100%</div><div class="stat-label" data-i18n="tool.stats.accuracy">Accuracy</div></div></div></div></div></section><footer><div class="container footer-container"><div class="footer-section"><a href="https://lollypopdf.com" class="footer-logo"><div class="logo-icon"><div class="logo-circle">LPdf</div><div class="logo-stem"></div></div><span class="logo-text">LollyPoPdf</span></a><h3 data-i18n="footer.follow">FOLLOW US</h3><div class="social-icons"><a href="https://www.facebook.com/people/Lollypopdf/61585752146066/" class="social-icon"><i class="fab fa-facebook-f"></i></a><a href="https://x.com/LollypopdfTools" class="social-icon"><i class="fab fa-x-twitter"></i></a><a href="https://www.instagram.com/lollypopdf_tools/" class="social-icon"><i class="fab fa-instagram"></i></a><a href="https://www.youtube.com/@LollyPoPdf_Tools" class="social-icon"><i class="fab fa-youtube"></i></a></div></div><div class="footer-section"><h4 data-i18n="footer.categories">Popular Categories</h4><ul class="footer-links"><li><a href="https://lollypopdf.com#pdf-tools" data-i18n="footer.categories.pdf">PDF Tools</a></li><li><a href="https://lollypopdf.com#image-tools" data-i18n="footer.categories.image">Image Tools</a></li><li><a href="https://lollypopdf.com#text-tools" data-i18n="footer.categories.text">Text Tools</a></li><li><a href="https://lollypopdf.com#audio-video-tools" data-i18n="footer.categories.av">Audio/Video Tools</a></li><li><a href="https://lollypopdf.com#web-developer-tools" data-i18n="footer.categories.web">WebDeveloper Tools</a></li><li><a href="https://lollypopdf.com#calculator-tools" data-i18n="footer.categories.calc">Calculator Tools</a></li><li><a href="https://lollypopdf.com#utility-tools" data-i18n="footer.categories.util">Utility Tools</a></li><li><a href="https://lollypopdf.com#color-tools" data-i18n="footer.categories.color">Color Tools</a></li></ul></div><div class="footer-section"><h4 data-i18n="footer.quicklinks">Quick Links</h4><ul class="footer-links"><li><a href="https://lollypopdf.com#home" data-i18n="nav.home">Home</a></li><li><a href="https://lollypopdf.com#tools" data-i18n="footer.links.tools">All Tools</a></li><li><a href="https://lollypopdf.com#faq.html" data-i18n="footer.links.faq">FAQ</a></li><li><a href="https://lollypopdf.com#contact.html" data-i18n="footer.links.contact">Contact</a></li><li><a href="https://lollypopdf.com#privacy-policy.html" data-i18n="footer.links.privacy">Privacy Policy</a></li><li><a href="https://lollypopdf.com#disclaimer.html" data-i18n="footer.links.disclaimer">Disclaimer</a></li><li><a href="https://lollypopdf.com#terms.html" data-i18n="footer.links.terms">Terms of Service</a></li></ul></div></div><div class="footer-line"></div><div class="copyright" data-i18n="footer.copyright">© 2025 LollyPoPDF. All rights reserved.</div></footer><div class="language-switcher"><button class="language-btn"><i class="fas fa-globe"></i><span id="currentLanguage">English</span></button><div class="language-dropdown" id="languageDropdown"><div class="language-option" data-lang="en">English</div><div class="language-option" data-lang="es">Español</div><div class="language-option" data-lang="fr">Français</div><div class="language-option" data-lang="de">Deutsch</div><div class="language-option" data-lang="it">Italiano</div><div class="language-option" data-lang="pt">Português</div><div class="language-option" data-lang="ja">日本語</div><div class="language-option" data-lang="ru">Pусский</div><div class="language-option" data-lang="ko">한국어</div><div class="language-option" data-lang="zh-CN">中文 (简体)</div><div class="language-option" data-lang="zh-TW">中文 (繁體)</div><div class="language-option" data-lang="ar">العربية</div><div class="language-option" data-lang="fa">فارسی</div><div class="language-option" data-lang="bg">Български</div><div class="language-option" data-lang="ca">Català</div><div class="language-option" data-lang="nl">Nederlands</div><div class="language-option" data-lang="el">Ελληνικά</div><div class="language-option" data-lang="hi">हिन्दी</div><div class="language-option" data-lang="te">తెలుగు</div><div class="language-option" data-lang="kn">ಕನ್ನಡ</div><div class="language-option" data-lang="ta">தமிழ்</div><div class="language-option" data-lang="ml">മലയാളം</div><div class="language-option" data-lang="id">Bahasa Indonesia</div><div class="language-option" data-lang="ms">Bahasa Melayu</div><div class="language-option" data-lang="pl">Polski</div><div class="language-option" data-lang="th">ภาษาไทย</div><div class="language-option" data-lang="tr">Türkçe</div><div class="language-option" data-lang="uk">Українська</div><div class="language-option" data-lang="vi">Tiếng Việt</div><div class="language-option" data-lang="is">Íslenska</div><div class="language-option" data-lang="no">Norsk</div><div class="language-option" data-lang="sv">Svenska</div><div class="language-option" data-lang="fi">Suomi</div><div class="language-option" data-lang="cs">Čeština</div></div></div><script>(function(){function p(){const b=e=>{e.preventDefault();e.stopPropagation();return false};document.addEventListener('contextmenu',b);document.addEventListener('dragstart',e=>{if(e.target.tagName==='IMG')return b(e)});document.addEventListener('keydown',e=>{const k=e.key,ctrl=e.ctrlKey,shift=e.shiftKey;if(k==='F12'||(ctrl&&shift&&(k==='I'||k==='C'||k==='J'))||(ctrl&&k==='u')||(ctrl&&k==='s')||(ctrl&&k==='c'&&!e.target.closest('input,textarea,.language-select,.transcription-output'))){e.preventDefault();return false}});const ad=()=>{const s=Date.now();Object.defineProperty(window,'console',{get:()=>{throw new Error('blocked')}});setInterval(()=>{if(Date.now()-s>1e5)debugger},50)};try{ad()}catch(e){}setInterval(()=>{const n=new Date();if(n.getHours()===3&&n.getMinutes()===0){sessionStorage.clear();localStorage.clear();location.reload()}},6e4)}p();const tr={en:{"nav.home":"Home","nav.about":"About Us","nav.tools":"Tools","nav.contact":"Contact","hero.title":"Speech to Text Tool","hero.description":"Convert speech to text with high accuracy - record audio and get instant transcription with automatic punctuation. All processing happens locally with complete privacy.","howto.title":"How to Use the Speech to Text Tool","howto.step1.title":"Select Language","howto.step1.description":"Choose your preferred language from the dropdown menu. The tool supports multiple languages for accurate transcription with local punctuation.","howto.step2.title":"Start Recording","howto.step2.description":"Click the 'Start Recording' button to begin live transcription. The tool will automatically transcribe your speech with punctuation.","howto.step3.title":"Transcribe & Preview","howto.step3.description":"Watch your speech being transcribed in real-time. The text will appear with proper punctuation and formatting.","howto.step4.title":"Copy or Email","howto.step4.description":"Copy the transcribed text to clipboard or send it directly to your email application with one click.","tool.title":"Speech to Text","tool.recording.title":"Record Audio","tool.recording.start":"Start Recording","tool.recording.stop":"Stop Recording","tool.language.title":"Language Selection","tool.transcription.title":"Transcription","tool.transcription.placeholder":"Your transcribed text will appear here...","tool.transcription.copy":"Copy Text","tool.transcription.email":"Create Email","tool.transcription.clear":"Clear","tool.loading":"Processing Audio...","tool.stats.duration":"Recording Time","tool.stats.words":"Words","tool.stats.characters":"Characters","tool.stats.accuracy":"Accuracy","footer.follow":"FOLLOW US","footer.categories":"Popular Categories","footer.categories.pdf":"PDF Tools","footer.categories.image":"Image Tools","footer.categories.text":"Text Tools","footer.categories.av":"Audio/Video Tools","footer.categories.web":"WebDeveloper Tools","footer.categories.calc":"Calculator Tools","footer.categories.util":"Utility Tools","footer.categories.color":"Color Tools","footer.quicklinks":"Quick Links","footer.links.tools":"All Tools","footer.links.faq":"FAQ","footer.links.contact":"Contact","footer.links.privacy":"Privacy Policy","footer.links.disclaimer":"Disclaimer","footer.links.terms":"Terms of Service","footer.copyright":"© 2025 LollyPoPDF. All rights reserved."}};['es','fr','de','it','pt','ja','ru','ko','zh-CN','zh-TW','ar','fa','bg','ca','nl','el','hi','te','kn','ta','ml','id','ms','pl','th','tr','uk','vi','is','no','sv','fi','cs'].forEach(c=>{if(!tr[c])tr[c]=JSON.parse(JSON.stringify(tr.en));});const langs=[{code:'af-ZA',name:'Afrikaans',local:'Afrikaans'},{code:'am-ET',name:'አማርኛ',local:'Amharic'},{code:'ar-SA',name:'العربية',local:'Arabic'},{code:'az-AZ',name:'Azərbaycanca',local:'Azerbaijani'},{code:'bn-BD',name:'বাংলা',local:'Bengali'},{code:'bg-BG',name:'Български',local:'Bulgarian'},{code:'ca-ES',name:'Català',local:'Catalan'},{code:'zh-CN',name:'中文',local:'Chinese (Simplified)'},{code:'zh-TW',name:'中文',local:'Chinese (Traditional)'},{code:'cs-CZ',name:'Čeština',local:'Czech'},{code:'da-DK',name:'Dansk',local:'Danish'},{code:'nl-NL',name:'Nederlands',local:'Dutch'},{code:'en-US',name:'English',local:'English'},{code:'fi-FI',name:'Suomi',local:'Finnish'},{code:'fr-FR',name:'Français',local:'French'},{code:'ka-GE',name:'ქართული',local:'Georgian'},{code:'de-DE',name:'Deutsch',local:'German'},{code:'el-GR',name:'Ελληνικά',local:'Greek'},{code:'gu-IN',name:'ગુજરાતી',local:'Gujarati'},{code:'hi-IN',name:'हिन्दी',local:'Hindi'},{code:'hu-HU',name:'Magyar',local:'Hungarian'},{code:'is-IS',name:'Íslenska',local:'Icelandic'},{code:'id-ID',name:'Bahasa Indonesia',local:'Indonesian'},{code:'it-IT',name:'Italiano',local:'Italian'},{code:'ja-JP',name:'日本語',local:'Japanese'},{code:'jv-ID',name:'Basa Jawa',local:'Javanese'},{code:'kn-IN',name:'ಕನ್ನಡ',local:'Kannada'},{code:'km-KH',name:'ភាសាខ្មែរ',local:'Khmer'},{code:'ko-KR',name:'한국어',local:'Korean'},{code:'lo-LA',name:'ລາວ',local:'Lao'},{code:'lv-LV',name:'Latviešu',local:'Latvian'},{code:'lt-LT',name:'Lietuvių',local:'Lithuanian'},{code:'ms-MY',name:'Bahasa Melayu',local:'Malay'},{code:'ml-IN',name:'മലയാളം',local:'Malayalam'},{code:'mr-IN',name:'मराठी',local:'Marathi'},{code:'ne-NP',name:'नेपाली',local:'Nepali'},{code:'no-NO',name:'Norsk',local:'Norwegian'},{code:'pl-PL',name:'Polski',local:'Polish'},{code:'pt-BR',name:'Português',local:'Portuguese'},{code:'ro-RO',name:'Română',local:'Romanian'},{code:'ru-RU',name:'Русский',local:'Russian'},{code:'sr-RS',name:'Српски',local:'Serbian'},{code:'si-LK',name:'සිංහල',local:'Sinhala'},{code:'sk-SK',name:'Slovenčina',local:'Slovak'},{code:'sl-SI',name:'Slovenščina',local:'Slovenian'},{code:'es-ES',name:'Español',local:'Spanish'},{code:'sv-SE',name:'Svenska',local:'Swedish'},{code:'ta-IN',name:'தமிழ்',local:'Tamil'},{code:'te-IN',name:'తెలుగు',local:'Telugu'},{code:'th-TH',name:'ภาษาไทย',local:'Thai'},{code:'tr-TR',name:'Türkçe',local:'Turkish'},{code:'uk-UA',name:'Українська',local:'Ukrainian'},{code:'ur-PK',name:'اُردُو',local:'Urdu'},{code:'vi-VN',name:'Tiếng Việt',local:'Vietnamese'}];const tT=document.getElementById('themeToggle'),b=document.body;const savedTheme=localStorage.getItem('theme');if(savedTheme==='dark'){b.classList.add('dark-mode');tT.innerHTML='<i class="fas fa-sun"></i>'}else{tT.innerHTML='<i class="fas fa-moon"></i>'}tT.addEventListener('click',()=>{b.classList.toggle('dark-mode');tT.innerHTML=b.classList.contains('dark-mode')?'<i class="fas fa-sun"></i>':'<i class="fas fa-moon"></i>';localStorage.setItem('theme',b.classList.contains('dark-mode')?'dark':'light');});document.getElementById('mobileMenuBtn').addEventListener('click',function(){const m=document.getElementById('mobileMenu');m.classList.toggle('active');this.innerHTML=m.classList.contains('active')?'<i class="fas fa-times"></i>':'<i class="fas fa-bars"></i>';});document.querySelectorAll('#mobileMenu a').forEach(l=>l.addEventListener('click',()=>{document.getElementById('mobileMenu').classList.remove('active');document.getElementById('mobileMenuBtn').innerHTML='<i class="fas fa-bars"></i>';}));const sel=document.getElementById('languageSelect');langs.forEach(l=>{const o=document.createElement('option');o.value=l.code;o.textContent=`${l.name} (${l.local})`;sel.appendChild(o);});const SR=window.SpeechRecognition||window.webkitSpeechRecognition;let rec=null;if(SR){try{rec=new SR();rec.continuous=true;rec.interimResults=true;rec.lang='en-US';rec.maxAlternatives=1;}catch(e){rec=null;}}let isR=false,sec=0,txt='',intv,mediaStream=null,restartTimeout=null;const rBtn=document.getElementById('recordBtn'),sBtn=document.getElementById('stopBtn'),ind=document.getElementById('recordingIndicator'),tim=document.getElementById('recordingTimer'),out=document.getElementById('transcriptionOutput'),cpy=document.getElementById('copyBtn'),eml=document.getElementById('emailBtn'),clr=document.getElementById('clearBtn'),ld=document.getElementById('loadingIndicator'),rt=document.getElementById('recordingTime'),wc=document.getElementById('wordCount'),cc=document.getElementById('characterCount'),acc=document.getElementById('accuracy');function formatTime(s){let m=Math.floor(s/60),se=s%60;return (m<10?'0'+m:m)+':'+(se<10?'0'+se:se);}function updateStats(){let w=txt.trim().split(/\s+/).filter(Boolean).length;wc.textContent=w;cc.textContent=txt.length;rt.textContent=formatTime(sec);}function addPunctuation(t,l){if(!t)return t;t=t.trim();if(/[a-zA-Z]/.test(t.charAt(0)))t=t.charAt(0).toUpperCase()+t.slice(1);let last=t.slice(-1);if(t.toLowerCase().includes('?')){if(last!=='?'&&last!=='？')t+='?';return t;}let qWords=['what','who','why','where','when','how','is','are','do','does'];let first=t.split(' ')[0].toLowerCase();if(qWords.includes(first)){if(last!=='?'&&last!=='？')t+='?';return t;}if(!/[.!?。！؟]$/.test(t)){let p='. ';if(l.startsWith('zh')||l.startsWith('ja'))p='。 ';else if(l.startsWith('hi'))p='। ';else if(l.startsWith('ar')||l.startsWith('fa'))p='۔ ';t+=p;}return t;}function cleanupMediaTracks(){if(mediaStream){mediaStream.getTracks().forEach(t=>t.stop());mediaStream=null;}}function safeStop(){if(restartTimeout){clearTimeout(restartTimeout);restartTimeout=null;}if(rec){try{rec.abort&&rec.abort();rec.stop();}catch(e){}}}if(rec){rec.onstart=()=>{ld.style.display='none';};rec.onresult=(e)=>{let interim='',final='';for(let i=e.resultIndex;i<e.results.length;i++){let transcript=e.results[i][0].transcript;if(e.results[i].isFinal){final+=transcript+' ';}else{interim+=transcript;}}if(final){final=addPunctuation(final,rec.lang);txt+=final;out.textContent=txt;updateStats();eml.style.display='flex';}if(interim){out.textContent=txt+interim;}};rec.onerror=(e)=>{ld.style.display='none';if(e.error==='not-allowed'){alert('Microphone access denied.');stopRecording();}else if(e.error==='no-speech'){if(isR){restartTimeout=setTimeout(()=>{if(isR&&rec){try{rec.start();}catch(e){stopRecording();}}},500);}}else{if(isR){restartTimeout=setTimeout(()=>{if(isR&&rec){try{rec.start();}catch(e){stopRecording();}}},1000);}}};rec.onend=()=>{ld.style.display='none';if(isR){restartTimeout=setTimeout(()=>{if(isR&&rec){try{rec.start();}catch(e){stopRecording();}}},500);}};}sel.addEventListener('change',()=>{if(rec)rec.lang=sel.value;});function stopRecording(){if(!isR)return;rBtn.style.display='flex';sBtn.style.display='none';ind.style.display='none';isR=false;clearInterval(intv);safeStop();cleanupMediaTracks();updateStats();}rBtn.addEventListener('click',async()=>{if(!rec){alert('Speech recognition unavailable.');return;}try{const stream=await navigator.mediaDevices.getUserMedia({audio:true});mediaStream=stream;txt='';out.textContent='Listening... Speak now.';eml.style.display='none';rBtn.style.display='none';sBtn.style.display='flex';ind.style.display='flex';isR=true;sec=0;intv=setInterval(()=>{sec++;tim.textContent=formatTime(sec);rt.textContent=formatTime(sec);},1000);safeStop();setTimeout(()=>{if(isR&&rec){try{rec.start();}catch(e){alert('Recognition start failed.');stopRecording();}}},200);}catch(err){alert('Microphone access required.');}});sBtn.addEventListener('click',stopRecording);cpy.addEventListener('click',()=>{if(!txt.trim()){alert('Nothing to copy');return;}if(navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(txt).then(()=>{let o=cpy.innerHTML;cpy.innerHTML='<i class="fas fa-check"></i> Copied!';setTimeout(()=>cpy.innerHTML=o,2000);}).catch(()=>fallbackCopy());}else{fallbackCopy();}function fallbackCopy(){let ta=document.createElement('textarea');ta.value=txt;document.body.appendChild(ta);ta.select();try{document.execCommand('copy')?alert('Copied!'):alert('Copy failed');}catch(e){alert('Copy failed');}document.body.removeChild(ta);}});eml.addEventListener('click',()=>{if(txt.trim()){window.location.href='mailto:?subject=Speech%20to%20Text%20Transcription&body='+encodeURIComponent(txt);}});clr.addEventListener('click',()=>{txt='';out.textContent='Your transcribed text will appear here...';eml.style.display='none';wc.textContent='0';cc.textContent='0';rt.textContent='0:00';sec=0;});const cSpan=document.getElementById('currentLanguage'),dDown=document.getElementById('languageDropdown');function changeLanguage(c){let d=tr[c];if(!d)return;document.querySelectorAll('[data-i18n]').forEach(el=>{let k=el.getAttribute('data-i18n');if(d[k])el.textContent=d[k];});let f=langs.find(l=>l.code===c);cSpan.textContent=f?f.name:'English';localStorage.setItem('language',c);}let sv=localStorage.getItem('language')||'en';changeLanguage(sv);dDown.addEventListener('click',(e)=>{if(e.target.classList.contains('language-option'))changeLanguage(e.target.getAttribute('data-lang'));});setInterval(()=>{acc.textContent='100%';},5000);})();</script></body></html>
